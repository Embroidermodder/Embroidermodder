\hypertarget{format__csd_8c_source}{}\doxysubsection{format\+\_\+csd.\+c}
\label{format__csd_8c_source}\index{embroidermodder2/extern/libembroidery/src/formats/format\_csd.c@{embroidermodder2/extern/libembroidery/src/formats/format\_csd.c}}
\mbox{\hyperlink{format__csd_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00001}00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00002}00002\ \textcolor{comment}{\ *\ VP3\ FORMAT}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00003}00003\ \textcolor{comment}{\ *\ This\ file\ is\ part\ of\ libembroidery.}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00004}00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00005}00005\ \textcolor{comment}{\ *\ Copyright\ 2018-\/2023\ The\ Embroidermodder\ Team}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00006}00006\ \textcolor{comment}{\ *\ Licensed\ under\ the\ terms\ of\ the\ zlib\ license.}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00007}00007\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00013}00013\ \textcolor{preprocessor}{\#include\ "{}../embroidery\_internal.h"{}}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00015}\mbox{\hyperlink{format__csd_8c_a4fcf3ace27e69d89af9b5e3e786c7fbe}{00015}}\ \textcolor{preprocessor}{\#define\ CsdSubMaskSize\ \ 479}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00016}\mbox{\hyperlink{format__csd_8c_af849ef7c88e1b71d667c96137faeee75}{00016}}\ \textcolor{preprocessor}{\#define\ CsdXorMaskSize\ \ 501}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00018}\mbox{\hyperlink{format__csd_8c_a423c4a85e6e184bafb11931bf48eb6d1}{00018}}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{format__csd_8c_a423c4a85e6e184bafb11931bf48eb6d1}{\_subMask}}[\mbox{\hyperlink{format__csd_8c_a4fcf3ace27e69d89af9b5e3e786c7fbe}{CsdSubMaskSize}}];}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00019}\mbox{\hyperlink{format__csd_8c_aff300a9cd128bc0dd787d94b4dc9dca6}{00019}}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{format__csd_8c_aff300a9cd128bc0dd787d94b4dc9dca6}{\_xorMask}}[\mbox{\hyperlink{format__csd_8c_af849ef7c88e1b71d667c96137faeee75}{CsdXorMaskSize}}];}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00021}\mbox{\hyperlink{format__csd_8c_a8088700999062a5c76345d7a8901c69b}{00021}}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{format__csd_8c_a8088700999062a5c76345d7a8901c69b}{csd\_decryptArray}}[]\ =\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00022}00022\ \ \ \ \ 0x43,\ 0x6E,\ 0x72,\ 0x7A,\ 0x76,\ 0x6C,\ 0x61,\ 0x6F,\ 0x7C,\ 0x29,\ 0x5D,\ 0x62,\ 0x60,\ 0x6E,\ 0x61,\ 0x62,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00023}00023\ \ \ \ \ 0x20,\ 0x41,\ 0x66,\ 0x6A,\ 0x3A,\ 0x35,\ 0x5A,\ 0x63,\ 0x7C,\ 0x37,\ 0x3A,\ 0x2A,\ 0x25,\ 0x24,\ 0x2A,\ 0x33,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00024}00024\ \ \ \ \ 0x00,\ 0x10,\ 0x14,\ 0x03,\ 0x72,\ 0x4C,\ 0x48,\ 0x42,\ 0x08,\ 0x7A,\ 0x5E,\ 0x0B,\ 0x6F,\ 0x45,\ 0x47,\ 0x5F,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00025}00025\ \ \ \ \ 0x40,\ 0x54,\ 0x5C,\ 0x57,\ 0x55,\ 0x59,\ 0x53,\ 0x3A,\ 0x32,\ 0x6F,\ 0x53,\ 0x54,\ 0x50,\ 0x5C,\ 0x4A,\ 0x56,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00026}00026\ \ \ \ \ 0x2F,\ 0x2F,\ 0x62,\ 0x2C,\ 0x22,\ 0x65,\ 0x25,\ 0x28,\ 0x38,\ 0x30,\ 0x38,\ 0x22,\ 0x2B,\ 0x25,\ 0x3A,\ 0x6F,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00027}00027\ \ \ \ \ 0x27,\ 0x38,\ 0x3E,\ 0x3F,\ 0x74,\ 0x37,\ 0x33,\ 0x77,\ 0x2E,\ 0x30,\ 0x3D,\ 0x34,\ 0x2E,\ 0x32,\ 0x2B,\ 0x2C,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00028}00028\ \ \ \ \ 0x0C,\ 0x18,\ 0x42,\ 0x13,\ 0x16,\ 0x0A,\ 0x15,\ 0x02,\ 0x0B,\ 0x1C,\ 0x1E,\ 0x0E,\ 0x08,\ 0x60,\ 0x64,\ 0x0D,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00029}00029\ \ \ \ \ 0x09,\ 0x51,\ 0x25,\ 0x1A,\ 0x18,\ 0x16,\ 0x19,\ 0x1A,\ 0x58,\ 0x10,\ 0x14,\ 0x5B,\ 0x08,\ 0x15,\ 0x1B,\ 0x5F,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00030}00030\ \ \ \ \ 0xD5,\ 0xD2,\ 0xAE,\ 0xA3,\ 0xC1,\ 0xF0,\ 0xF4,\ 0xE8,\ 0xF8,\ 0xEC,\ 0xA6,\ 0xAB,\ 0xCD,\ 0xF8,\ 0xFD,\ 0xFB,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00031}00031\ \ \ \ \ 0xE2,\ 0xF0,\ 0xFE,\ 0xFA,\ 0xF5,\ 0xB5,\ 0xF7,\ 0xF9,\ 0xFC,\ 0xB9,\ 0xF5,\ 0xEF,\ 0xF4,\ 0xF8,\ 0xEC,\ 0xBF,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00032}00032\ \ \ \ \ 0xC3,\ 0xCE,\ 0xD7,\ 0xCD,\ 0xD0,\ 0xD7,\ 0xCF,\ 0xC2,\ 0xDB,\ 0xA4,\ 0xA0,\ 0xB0,\ 0xAF,\ 0xBE,\ 0x98,\ 0xE2,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00033}00033\ \ \ \ \ 0xC2,\ 0x91,\ 0xE5,\ 0xDC,\ 0xDA,\ 0xD2,\ 0x96,\ 0xC4,\ 0x98,\ 0xF8,\ 0xC9,\ 0xD2,\ 0xDD,\ 0xD3,\ 0x9E,\ 0xDE,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00034}00034\ \ \ \ \ 0xAE,\ 0xA5,\ 0xE2,\ 0x8C,\ 0xB6,\ 0xAC,\ 0xA3,\ 0xA9,\ 0xBC,\ 0xA8,\ 0xA6,\ 0xEB,\ 0x8B,\ 0xBF,\ 0xA1,\ 0xAC,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00035}00035\ \ \ \ \ 0xB5,\ 0xA3,\ 0xBB,\ 0xB6,\ 0xA7,\ 0xD8,\ 0xDC,\ 0x9A,\ 0xAA,\ 0xF9,\ 0x82,\ 0xFB,\ 0x9D,\ 0xB9,\ 0xAB,\ 0xB3,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00036}00036\ \ \ \ \ 0x94,\ 0xC1,\ 0xA0,\ 0x8C,\ 0x8B,\ 0x8E,\ 0x95,\ 0x8F,\ 0x87,\ 0x99,\ 0xE7,\ 0xE1,\ 0xA3,\ 0x83,\ 0x8B,\ 0xCF,}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00037}00037\ \ \ \ \ 0xA3,\ 0x85,\ 0x9D,\ 0x83,\ 0xD4,\ 0xB7,\ 0x83,\ 0x84,\ 0x91,\ 0x97,\ 0x9F,\ 0x88,\ 0x8F,\ 0xDD,\ 0xAD,\ 0x90}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00038}00038\ \};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00041}00041\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00042}\mbox{\hyperlink{format__csd_8c_ac51746f5cf90188f494419ffe291ce59}{00042}}\ \mbox{\hyperlink{format__csd_8c_ac51746f5cf90188f494419ffe291ce59}{BuildDecryptionTable}}(\textcolor{keywordtype}{int}\ seed)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00043}00043\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00044}00044\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ mul1\ =\ 0x41C64E6D;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00045}00045\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ add1\ =\ 0x3039;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{format__csd_8c_a4fcf3ace27e69d89af9b5e3e786c7fbe}{CsdSubMaskSize}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00048}00048\ \ \ \ \ \ \ \ \ seed\ *=\ mul1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00049}00049\ \ \ \ \ \ \ \ \ seed\ +=\ add1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00050}00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{format__csd_8c_a423c4a85e6e184bafb11931bf48eb6d1}{\_subMask}}[i]\ =\ (char)\ ((seed\ >>\ 16)\ \&\ 0xFF);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00051}00051\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{format__csd_8c_af849ef7c88e1b71d667c96137faeee75}{CsdXorMaskSize}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00053}00053\ \ \ \ \ \ \ \ \ seed\ *=\ mul1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00054}00054\ \ \ \ \ \ \ \ \ seed\ +=\ add1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00055}00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{format__csd_8c_aff300a9cd128bc0dd787d94b4dc9dca6}{\_xorMask}}[i]\ =\ (char)\ ((seed\ >>\ 16)\ \&\ 0xFF);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00056}00056\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00057}00057\ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00059}\mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{00059}}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(\textcolor{keywordtype}{long}\ fileOffset,\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ val,\ \textcolor{keywordtype}{int}\ type)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00061}00061\ \ \ \ \ \textcolor{keywordtype}{int}\ newOffset;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00063}00063\ \ \ \ \ fileOffset\ =\ fileOffset\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keyword}{final};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ fileOffsetHigh\ =\ (int)\ (fileOffset\ \&\ 0xFFFFFF00);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ fileOffsetLow\ =\ (int)\ (fileOffset\ \&\ 0xFF);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ newOffset\ =\ fileOffsetLow;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00070}00070\ \ \ \ \ \ \ \ \ fileOffsetLow\ =\ fileOffsetHigh;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{keyword}{final}\ =\ fileOffsetLow\%0x300;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{final}\ !=\ 0x100\ \&\&\ \textcolor{keyword}{final}\ !=\ 0x200)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ newOffset\ =\ \mbox{\hyperlink{format__csd_8c_a8088700999062a5c76345d7a8901c69b}{csd\_decryptArray}}[newOffset]\ |\ fileOffsetHigh;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00074}00074\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{final}\ !=\ 0x100\ \&\&\ \textcolor{keyword}{final}\ ==\ 0x200)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newOffset\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileOffsetHigh\ =\ fileOffsetHigh\ -\/\ 0x100;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ newOffset\ =\ \mbox{\hyperlink{format__csd_8c_a8088700999062a5c76345d7a8901c69b}{csd\_decryptArray}}[newOffset]\ |\ fileOffsetHigh;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00079}00079\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (newOffset\ !=\ 1\ \&\&\ newOffset\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ newOffset\ =\ \mbox{\hyperlink{format__csd_8c_a8088700999062a5c76345d7a8901c69b}{csd\_decryptArray}}[newOffset]\ |\ fileOffsetHigh;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00081}00081\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ fileOffsetHigh\ =\ fileOffsetHigh\ -\/\ 0x100;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ newOffset\ =\ \mbox{\hyperlink{format__csd_8c_a8088700999062a5c76345d7a8901c69b}{csd\_decryptArray}}[newOffset]\ |\ fileOffsetHigh;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00084}00084\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00085}00085\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00086}00086\ \ \ \ \ \ \ \ \ newOffset\ =\ (int)\ fileOffset;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00087}00087\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00088}00088\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})\ ((\textcolor{keywordtype}{unsigned}\ char)}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00089}00089\ \ \ \ \ \ \ \ \ (val\ \string^\ \mbox{\hyperlink{format__csd_8c_aff300a9cd128bc0dd787d94b4dc9dca6}{\_xorMask}}[newOffset\%\mbox{\hyperlink{format__csd_8c_af849ef7c88e1b71d667c96137faeee75}{CsdXorMaskSize}}])\ -\/}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{format__csd_8c_a423c4a85e6e184bafb11931bf48eb6d1}{\_subMask}}[newOffset\%\mbox{\hyperlink{format__csd_8c_a4fcf3ace27e69d89af9b5e3e786c7fbe}{CsdSubMaskSize}}]));}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00091}00091\ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00093}00093\ \textcolor{keywordtype}{char}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00094}\mbox{\hyperlink{embroidery__internal_8h_a13d793c9fa7f0366e371e2ba5bc795ce}{00094}}\ \mbox{\hyperlink{format__csd_8c_a13d793c9fa7f0366e371e2ba5bc795ce}{readCsd}}(\mbox{\hyperlink{struct_emb_pattern__}{EmbPattern}}*\ pattern,\ FILE*\ file)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00095}00095\ \ \ \ \ \textcolor{keywordtype}{int}\ i,\ type\ =\ 0;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00096}00096\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ identifier[8];}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00097}00097\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ unknown1,\ unknown2;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00098}00098\ \ \ \ \ \textcolor{keywordtype}{char}\ dx\ =\ 0,\ dy\ =\ 0;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00099}00099\ \ \ \ \ \textcolor{keywordtype}{int}\ colorChange\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00100}00100\ \ \ \ \ \textcolor{keywordtype}{int}\ flags;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00101}00101\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ colorOrder[14];}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00103}00103\ \ \ \ \ fread(identifier,\ 1,\ 8,\ file);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00104}00104\ \ \ \ \ \textcolor{comment}{/*\ TODO:\ check\ return\ value\ */}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00106}00106\ \ \ \ \ \textcolor{keywordflow}{if}\ (identifier[0]\ !=\ 0x7C\ \&\&\ identifier[2]\ !=\ 0xC3)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00107}00107\ \ \ \ \ \ \ \ \ type\ =\ 1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00108}00108\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00109}00109\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00110}00110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{format__csd_8c_ac51746f5cf90188f494419ffe291ce59}{BuildDecryptionTable}}(0xC);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00111}00111\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00112}00112\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{format__csd_8c_ac51746f5cf90188f494419ffe291ce59}{BuildDecryptionTable}}(identifier[0]);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00113}00113\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 16;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00116}00116\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_emb_thread__}{EmbThread}}\ thread;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00117}00117\ \ \ \ \ \ \ \ \ thread.\mbox{\hyperlink{struct_emb_thread___a5b70f2bf502560229b7fecf8984e33e9}{color}}.\mbox{\hyperlink{struct_emb_color___afd7b1ea9ff115205b65e0bffc92946ac}{r}}\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00118}00118\ \ \ \ \ \ \ \ \ thread.\mbox{\hyperlink{struct_emb_thread___a5b70f2bf502560229b7fecf8984e33e9}{color}}.\mbox{\hyperlink{struct_emb_color___a83576af39a9f289a28c1263d61073508}{g}}\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00119}00119\ \ \ \ \ \ \ \ \ thread.\mbox{\hyperlink{struct_emb_thread___a5b70f2bf502560229b7fecf8984e33e9}{color}}.\mbox{\hyperlink{struct_emb_color___a41cede1b4c0d05cff170ad5761f70964}{b}}\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00120}00120\ \ \ \ \ \ \ \ \ strcpy(thread.\mbox{\hyperlink{struct_emb_thread___a078d3842e4fd90843020a4e39abb6822}{catalogNumber}},\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00121}00121\ \ \ \ \ \ \ \ \ strcpy(thread.\mbox{\hyperlink{struct_emb_thread___a54075ac9418786f6ce2c360f8a90d85a}{description}},\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00122}00122\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{embroidery_8h_a1b281916881a27935b9e1f6bcffb2087}{embPattern\_addThread}}(pattern,\ thread);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00123}00123\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00124}00124\ \ \ \ \ unknown1\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00125}00125\ \ \ \ \ unknown2\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00126}00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{embroidery_8h_a3e3a5b8efffea93c4268a39ee5690098}{emb\_verbose}}>1)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00127}00127\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}unknown\ bytes\ to\ decode:\ \%c\ \%c"{}},\ unknown1,\ unknown2);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00128}00128\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00130}00130\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 14;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00131}00131\ \ \ \ \ \ \ \ \ colorOrder[i]\ =\ (\textcolor{keywordtype}{unsigned}\ char)\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ char)fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00132}00132\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00133}00133\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ !feof(file);\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ negativeX,\ negativeY;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ b0\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ b1\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ b2\ =\ \mbox{\hyperlink{format__csd_8c_a50f9ec4268b8a349c4519d0a91ae9c21}{DecodeCsdByte}}(ftell(file),\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})fgetc(file),\ type);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (b0\ ==\ 0xF8\ ||\ b0\ ==\ 0x87\ ||\ b0\ ==\ 0x91)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00141}00141\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00142}00142\ \ \ \ \ \ \ \ \ negativeX\ =\ ((b0\ \&\ 0x20)\ >\ 0);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00143}00143\ \ \ \ \ \ \ \ \ negativeY\ =\ ((b0\ \&\ 0x40)\ >\ 0);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00144}00144\ \ \ \ \ \ \ \ \ b0\ =\ (\textcolor{keywordtype}{unsigned}\ char)(b0\ \&\ (0xFF\ \string^\ 0xE0));}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((b0\ \&\ 0x1F)\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ flags\ =\ \mbox{\hyperlink{embroidery_8h_a1291f416b069313021b519eea62d5bf1}{NORMAL}};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00148}00148\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((b0\ \&\ 0x0C)\ >\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ flags\ =\ \mbox{\hyperlink{embroidery_8h_ae19b6bb2940d2fbe0a79852b070eeafd}{STOP}};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (colorChange\ >=\ 14)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Invalid\ color\ change\ detected\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{embroidery_8h_abeb4c0f3d40c17445df2aeef9677c10e}{embPattern\_changeColor}}(pattern,\ colorOrder[colorChange\ \ \%\ 14]);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ colorChange\ +=\ 1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00155}00155\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((b0\ \&\ 0x1F)\ >\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ flags\ =\ \mbox{\hyperlink{embroidery_8h_a26f53b7361e8f4529b048dfa1237908a}{TRIM}};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00157}00157\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ flags\ =\ \mbox{\hyperlink{embroidery_8h_a1291f416b069313021b519eea62d5bf1}{NORMAL}};}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00159}00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00160}00160\ \ \ \ \ \ \ \ \ dx\ =\ (char)\ b2;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00161}00161\ \ \ \ \ \ \ \ \ dy\ =\ (char)\ b1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00162}00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (negativeX)\ \{\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ dx\ =\ (char)\ -\/dx;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00164}00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (negativeY)\ \{\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ dy\ =\ (char)\ -\/dy;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00167}00167\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00168}00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flags\ ==\ \mbox{\hyperlink{embroidery_8h_ae19b6bb2940d2fbe0a79852b070eeafd}{STOP}})\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{embroidery_8h_aa2c02d649c5a2ac8513514da7b0b5fc1}{embPattern\_addStitchRel}}(pattern,\ 0,\ 0,\ flags,\ 1);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00170}00170\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{embroidery_8h_aa2c02d649c5a2ac8513514da7b0b5fc1}{embPattern\_addStitchRel}}(pattern,\ dx\ /\ 10.0,\ dy\ /\ 10.0,\ flags,\ 1);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00172}00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00173}00173\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00174}00174\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00175}00175\ \}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00177}00177\ \textcolor{keywordtype}{char}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00178}\mbox{\hyperlink{embroidery__internal_8h_ac48ab7a06130111eabb754be9de5089b}{00178}}\ \mbox{\hyperlink{format__csd_8c_ac48ab7a06130111eabb754be9de5089b}{writeCsd}}(\mbox{\hyperlink{struct_emb_pattern__}{EmbPattern}}*\ pattern,\ FILE*\ file)\ \{}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00179}00179\ \ \ \ \ puts(\textcolor{stringliteral}{"{}writeCsd\ is\ not\ implemented."{}});}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00180}00180\ \ \ \ \ puts(\textcolor{stringliteral}{"{}Overridden,\ defaulting\ to\ dst."{}});}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00181}00181\ \ \ \ \ \mbox{\hyperlink{embroidery__internal_8h_a5b971603eb8cc707cfd0167659fd8aab}{writeDst}}(pattern,\ file);}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00182}00182\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;\ \textcolor{comment}{/*TODO:\ finish\ writeCsd\ */}}
\DoxyCodeLine{\Hypertarget{format__csd_8c_source_l00183}00183\ \}}

\end{DoxyCode}
