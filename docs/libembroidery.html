<!DOCTYPE html>
<html>
<head>
    <title>Embroidermodder</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="description" content="Embroidery Software and Hardware"/>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="keywords" content="embroidery, stitching, quilting, sewing, cad, drafting, 10o, 100, art, bmc, bro, c, c++, cam, cnc, cnd, csv, dat, dem, dsb, dst, dsz, dxf, edr, emd, exp, exy, eys, fxy, gnc, gt, hus, inb, inf, jef, ksm, max, mit, new, ofm, pcd, pcm, pcq, pcs, pec, pel, pem, pes, phb, phc, plt, rgb, sew, shv, sst, stx, svg, t09, tap, thr, u00, u01, vip, vp3, xxx, zsk" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="shortcut icon" type="image/png" href="favicon.png" />
<style>
body
{
    background-color: #FFFFFF;
    background-image: url("images/texture-spirals.png");
    min-width: 700px;
    margin: 0;
    padding: 0;
    font-family: serif;
}

img
{
    border: 0;
}

a
{
    text-decoration: none;
    color: #55C4E6;
}

a:link
{
    text-decoration: none;
    color: #55C4E6;
}

table, th, td
{
    border: 1px solid black;
    border-collapse:collapse;
    padding-left:5px;
    padding-right:10px;
}

th
{
    color:#0C6AB0;
    background-color:#000000;
    text-align:left;
}

td
{
    color:#000000;
    background-color:#DDDDDD;
}

@media all and (min-width: 1000px) {
    #menu {
        float: top;
        position: relative;
        background-color: #000000;
        left: 0;
        top: 0;
        padding-bottom: 1em;
        padding-left: 8em;
        color: #0C6AB0;
        font-family: serif;
        font-style: italic;
    }
    
    #menu a {
        color: #0C6AB0;
    }

    #menuUp {
        position: relative;
        float: left;
        top: 0;
        bottom: 35px;
        padding-right: 40px;
        padding-right: 1.5em;
    }

    #menuUp:hover {
        color:#2C8AD0;
    }

    #container {
        position: relative;
        background-color: #000000;
        top: 4em;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        font-size: 18px;
    }

    .contentPanel {
        background-color: #FFFFFF;
        color: #001537;
        position: relative;
        padding-left: 8em;
        padding-right: 16em;
        padding-bottom: 3em;
        position: relative;
        left: 0;
        right: 0;
        top: 1.5em;
        bottom: 0;
        min-height: 20em;
        font-size: 16px;
        line-height: 1.8;
    }
}

@media all and (max-width: 1000px) {
    #menu {
        float: top;
        position: relative;
        background-color: #000000;
        left: 0;
        top: 0;
        padding-bottom: 1em;
        padding-left: 3em;
        color: #0C6AB0;
        font-family: serif;
        font-style: italic;
    }
    
    #menu a {
        color: #0C6AB0;
    }

    #menuUp {
        position: relative;
        float: left;
        top: 0;
        bottom: 35px;
        padding-right: 40px;
        padding-right: 1.5em;
    }

    #menuUp:hover {
        color:#2C8AD0;
    }

    #container {
        position: relative;
        background-color: #000000;
        top: 4em;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        font-size: 16px;
    }

    .contentPanel {
        background-color: #FFFFFF;
        color: #001537;
        position: relative;
        padding-left: 3em;
        padding-right: 3em;
        padding-bottom: 3em;
        position: relative;
        left: 0;
        right: 0;
        top: 1.5em;
        bottom: 0;
        min-height: 20em;
        font-size: 14px;
        line-height: 1.8;
    }
}

.video
{
    position: relative;
    padding-bottom: 56.25%; /* 16/9 ratio */
    padding-top: 30px; /* IE6 workaround*/
    height: 0;
    overflow: hidden;
}

.video iframe,
.video object,
.video embed
{
    position: absolute;
    top: 0;
    left: 0;
    width: 80%;
    height: 80%;
}

.img
{
    width: 80%;
    max-height: auto;
}

.icon
{
    padding-top: 5px;
    width: 32px;
    height: 32px;
}
</style>

</head>

<body>
    <div id="container">
    <!-- CONTENT START -->
    <div id="menu">
        <br>
        <a href="index.html"><img src="images/header-center.png"></img></a>
        <br>
        <a href="index.html"><div id="menuUp">News</div></a>
        <a href="about.html"><div id="menuUp">About</div></a>
        <a href="documentation.html"><div id="menuUp">Documentation</div></a>
        <a href="libembroidery.html"><div id="menuUp">Libembroidery</div></a>
        <a href="downloads.html"><div id="menuUp">Downloads</div></a>
        <a href="contact.html"><div id="menuUp">Contact</div></a>
    </div>
    <div class="contentPanel">
    <br>
    <!-- converted markdown goes here -->
<h1 id="libembroidery-v1.0-alpha-manual">Libembroidery v1.0-alpha Manual</h1>
<h2 id="what-is-libembroidery">What is libembroidery?</h2>
<p>libembroidery is a low-level library for reading, writing, and altering digital embroidery files in C.</p>
<p>libembroidery is the underlying library that is used by <a href="http://embroidermodder.org">Embroidermodder 2</a> and is developed by <a href="#the-embroidermodder-team">The Embroidermodder Team</a>. It handles over 45 different embroidery specific formats as well as several non-embroidery specific vector formats.</p>
<p>It also includes a CLI called <code>embroider</code> that allows for better automation of changes to embroidery files and will be more up-to date than the Embroidermodder 2 GUI.</p>
<p>If you want to find a simple fix to contribute see the <em>Development</em> section of the manual.</p>
<p>https://embroidermodder.org</p>
<p>Copyright (c) 2013-2022 The EmbroiderModder Team</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#what-is-libembroidery">What is libembroidery?</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#license">License</a></li>
<li><a href="#the-embroidermodder-team">The Embroidermodder Team</a></li>
<li><a href="#build">Build</a>
<ul>
<li><a href="#debug">Debug</a></li>
</ul></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#coding-standards">Coding Standards</a>
<ul>
<li><a href="#naming-conventions">Naming Conventions</a></li>
<li><a href="#braces">Braces</a></li>
<li><a href="#comments">Comments</a></li>
</ul></li>
<li><a href="#formats">Formats</a></li>
<li><a href="#features">Features</a>
<ul>
<li><a href="#bindings">Bindings</a></li>
</ul></li>
<li><a href="#on-embedded-systems">On Embedded Systems</a>
<ul>
<li><a href="#compatible-boards">Compatible Boards</a></li>
<li><a href="#arduino-considerations">Arduino Considerations</a></li>
<li><a href="#space">Space</a></li>
<li><a href="#tables">Tables</a></li>
<li>Current Pattern Memory Management</li>
<li>Special Notes</li>
<li>Experimental Projects</li>
<li>Dependencies</li>
</ul></li>
<li>The Assembly Split
<ul>
<li>Utility Functions</li>
<li>Avoiding the use of libc</li>
<li>Avoiding the use of libm</li>
</ul></li>
<li><a href="#bibliography">Bibliography</a></li>
</ul>
<h3 id="license">License</h3>
<p>Libembroidery is distributed under the permissive zlib licence, see the LICENCE file. Libembroidery consists of roughly 16k source lines of code in C: <code>embroidery.c</code>, <code>embroidery.h</code>, <code>thread-color.c</code> and <code>formats.c</code>. There are 3 supporting files: the <code>LICENCE</code>, this <code>README</code> and a build file (<code>CMakeLists.txt</code>). The licence covers these 7 files.</p>
<h3 id="the-embroidermodder-project">The Embroidermodder Project</h3>
<p>The <em>Embroidermodder 2</em> project is a collection of small software utilities for manipulating, converting and creating embroidery files in all major embroidery machine formats. The program <em>Embroidermodder 2</em> itself is a larger graphical user interface (GUI) which is at the heart of the project.</p>
<p>This manual, the website (<code>embroidermodder.org</code>), mobile embroidery format viewers and tools (<code>iMobileViewer</code>, <code>MobileViewer</code>), the core library of functions (<code>libembroidery</code>) and CLI (<code>embroider</code>) are all tools to make the standard user experience of working with an embroidery machine better without expensive software which is locked to specific manufacturers and formats. But ultimately we hope that the core <em>Embroidermodder 2</em> is a practical, ever-present tool in larger workshops, small cottage industry workshops and personal hobbyist’s bedrooms.</p>
<p>Embroidermodder 2 is licensed under the zlib license and we aim to keep all of our tools open source and free of charge. If you would like to support the project check out our Open Collective group. If you would like to help, please join us on GitHub. This document is written as developer training as well helping new users (see the last sections) so this is the place to learn how to start changing the code.</p>
<h3 id="the-embroidermodder-team">The Embroidermodder Team</h3>
<p>The Embroidermodder Team is the collection of people who’ve submitted patches, artwork and documentation to our three projects. The team was established by Jonathan Greig and Josh Varga. For a full list of members please see the <a href="https://github.com/Embroidermodder/Embroidermodder">Embroidermodder github page</a> where it is actively maintained.</p>
<h2 id="build">Build</h2>
<p>libembroidery and EmbroiderModder 2 use CMake builds so if you are building the project to use as a library we recommend you run:</p>
<pre><code>git clone https://github.com/Embroidermodder/libembroidery
cd libembroidery
cmake .
cmake --build .
cmake --install .</code></pre>
<p>This builds both the static and shared versions of the library as well as the command line program <code>embroider</code>.</p>
<h3 id="debug">Debug</h3>
<p>If you wish to help with development, <a href="https://embroidermodder.org/libembroidery_debugger.sh">run this debug script</a> and send us the error log. Note: this is maintained outside of the repository because it gives us a oneliner for new systems with a stable URL:</p>
<pre><code>curl https://embroidermodder.org/libembroidery_debugger.sh | sh</code></pre>
<p>While we will attempt to maintain good results from this script as part of normal development it should be the first point of failure on any system we haven’t tested or format we understand less.</p>
<h2 id="usage">Usage</h2>
<p>For basic use, we recommend you build as above, then run without arguments:</p>
<pre><code>$ embroider</code></pre>
<p>which will print out this advice on how to use these tools without digging straight into the rest of this manual.</p>
<pre><code>EMBROIDER
    A command line program for machine embroidery.
    Copyright 2013-2021 The Embroidermodder Team
    Licensed under the terms of the zlib license.

    https://github.com/Embroidermodder/libembroidery
    https://embroidermodder.org

Usage: embroider [OPTIONS] fileToRead...

Conversion:
-t, -to         Convert all files given to the format specified
                by the arguments to the flag, for example:
                    $ embroider -t dst input.pes
                would convert \&quot;input.pes\&quot; to \&quot;input.dst\&quot;
                in the same directory the program runs in.

                The accepted input formats are (TO BE DETERMINED).
                The accepted output formats are (TO BE DETERMINED).

Output:
-h, -help       Print this message.
-f, -format     Print help on the formats that
                embroider can deal with.
-q, -quiet      Only print fatal errors.
-V, -verbose    Print everything that has reporting.
-v, -version    Print the version.

Graphics:
-c, -circle     Add a circle defined by the arguments
                given to the current pattern.
-e, -ellipse    Add a circle defined by the arguments
                given to the current pattern.
-l, -line       Add a line defined by the arguments
                given to the current pattern.
-P, -polyline   Add a polyline.
-p, -polygon    Add a polygon.
-s, -satin      Fill the current geometry with satin
                stitches according
                to the defined algorithm.
-S, -stitch     Add a stitch defined by the arguments
                given to the current pattern.

Quality Assurance:
    -test       Run the test suite.</code></pre>
<p>For each of the flags described here we will go into greater detail in this manual.</p>
<h3 id="to-flag">To Flag</h3>
<h3 id="circle-flag">Circle Flag</h3>
<h3 id="ellipse-flag">Ellipse Flag</h3>
<h3 id="line-flag">Line Flag</h3>
<h3 id="polyline-flag">Polyline Flag</h3>
<h3 id="polygon-flag">Polygon Flag</h3>
<h3 id="satin-flag">Satin Flag</h3>
<h3 id="stitch-flag">Stitch Flag</h3>
<h3 id="section"></h3>
<h3 id="basic-test-suite">Basic Test Suite</h3>
<p>The flag <code>--test</code> runs the tests that take the least time and have the most utility. If you’re submitting a patch for review, please run:</p>
<pre><code>$ embroider --test | tail -n 1</code></pre>
<p>You’ll be presented with an overall PASS or FAIL for your build, if your build fails you can try and trace the error with:</p>
<pre><code>$ valgrind embroider --verbose --test</code></pre>
<p>or</p>
<pre><code>$ gdb --args embroider --verbose --test</code></pre>
<p>depending on your preferred debugging approach. Passing this test will be required for us to accept your patch.</p>
<h3 id="full-test-suite">Full Test Suite</h3>
<p>The flag <code>--full-test-suite</code> runs all the tests that have been written. Since this results in a lot of output the details are both to stdout and to a text file called <code>test_matrix.txt</code>.</p>
<p>Patches that strictly improve the results in the <code>test_matrix.txt</code> over the current version will likely be accepted and it’ll be a good place to go digging for contributions. (Note: strictly improve means that the testing result for each test is as good a result, if not better. Sacrificing one critera for another would require some design work before we would consider it.)</p>
<h2 id="ideas">Ideas</h2>
<h4 id="rendering-system">Rendering system</h4>
<p>There are two forms of render that will be produced.</p>
<ol type="1">
<li>A raster format as ppm so we can have a pixel for pixel output (for example extracting the embedded images in some formats).</li>
<li>The SVG format that will be fairly similar to InkStitch’s format.</li>
</ol>
<p>We have an EmbImage struct to store the raster format.</p>
<pre><code>$ embroider test01.csv --render</code></pre>
<p>currently creates a blank image. Previously the Hilbert curve test managed to create a correctly rendered version.</p>
<h4 id="binary-download">Binary download</h4>
<p>We need a current <code>embroider</code> command line program download, so people can update without building.</p>
<h4 id="identify-the-meaning-of-these-todo-items">Identify the meaning of these TODO items</h4>
<ul>
<li>Saving CSV/SVG (rt) + CSV read/write UNKNOWN interpreted as COLOR bug #179</li>
<li>Lego Mindstorms NXT/EV3 ports and/or commands</li>
</ul>
<h4 id="progress-chart">Progress Chart</h4>
<p>The chart of successful from-to conversions (previously a separate issue) is something that should appear in the README.</p>
<h4 id="tactile-art-and-braille-support">Tactile art and braille support</h4>
<p>One application I’d like to leave a reminder here for is automating embroidery for blind and partially sighted people.</p>
<p>There are many limitations to making braille (cost, poor support, lack of widespread adoption in the sighted world) and as such there is a strong DIY culture around it.</p>
<p>There are blind internet users who can also run terminal applications using a refreshable braille display, so in theory we could support an application like this for them:</p>
<pre><code>$ embroider --braille &quot;Hello, world!&quot; hello.dst</code></pre>
<p>which would produce braille that would read “Hello, world!” as an embroidery design.</p>
<p>Another option is tactile fills that use the same fill algorithms but are designed better to facilitate tactile art.</p>
<p>I think the way forward on this is to call up the RNIB business advice line and ask for assistance once we have a working model. That way they can get us in contact with experts to review how legible the output is and usable the software is for the intended audience.</p>
<p>This is less important than getting better machine support but given the high social impact I think it should be a priority.</p>
<h2 id="coding-standards">Coding Standards</h2>
<p>A basic set of guidelines to use when submitting code.</p>
<h3 id="naming-conventions">Naming Conventions</h3>
<ul>
<li>Name variables and functions intelligently to minimize the need for comments.</li>
<li>It should be immediately obvious what information it represents.</li>
<li>Short names such as x and y are fine when referring to coordinates.</li>
<li>Short names such as i and j are fine when doing loops.</li>
<li>Variable names should be “camelCase”, starting with a lowercase word followed by uppercase word(s).</li>
<li>C++ Class Names should be “CamelCase”, using all uppercase word(s).</li>
<li>C Functions that attempt to simulate namespacing, should be “nameSpace_camelCase”.</li>
<li>All files and directories shall be lowercase and contain no spaces.</li>
<li>Tabs should not be used when indenting. Setup your IDE or text editor to use 4 spaces.</li>
</ul>
<h3 id="braces">Braces</h3>
<p>For functions: please put each brace on a new line.</p>
<pre><code>void function_definition(int argument)
{

}</code></pre>
<p>For control statements: please put the first brace on the same line.</p>
<pre><code>if (condition) {

}</code></pre>
<p>Do not use ternary operator (?:) in place of if/else.</p>
<p>Do not repeat a variable name that already occurs in an outer scope.</p>
<h3 id="comments">Comments</h3>
<p>When writing code, sometimes there are items that we know can be improved, incomplete or need special clarification. In these cases, use the types of comments shown below. They are pretty standard and are highlighted by many editors to make reviewing code easier. We also use shell scripts to parse the code to find all of these occurrences so someone wanting to go on a bug hunt will be able to easily see which areas of the code need more love.</p>
<p>libembroidery is written in C and adheres to C89 standards. This means that any C99 or C++ comments will show up as errors when compiling with gcc.</p>
<h2 id="formats">Formats</h2>
<h3 id="overview">Overview</h3>
<h4 id="readwrite-support-levels">Read/Write Support Levels</h4>
<p>The table of read/write format support levels uses the status levels described here:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>None (0)</td>
<td>Either the format produces no output, reporting an error. Or it produces a Tajima dst file as an alternative.</td>
</tr>
<tr class="even">
<td>Poor (1)</td>
<td>A file somewhat similar to our examples is produced. We don’t know how well it runs on machines in practice as we don’t have any user reports or personal tests.</td>
</tr>
<tr class="odd">
<td>Basic (2)</td>
<td>Simple files in this format run well on machines that use this format.</td>
</tr>
<tr class="even">
<td>Standard (3)</td>
<td>Files with non-standard features work on machines and we have good documentation on the format.</td>
</tr>
<tr class="odd">
<td>Reliable (4)</td>
<td>All known features don’t cause crashes. Almost all work as expected.</td>
</tr>
<tr class="even">
<td>Good (5)</td>
<td>All known features of the format work on machines that use this format. Translations from and to this format preserve all features present in both.</td>
</tr>
</tbody>
</table>
<p>So all formats can, in principle, have good read and good write support, because it’s defined in relation to files that we have described the formats for.</p>
<h4 id="test-support-levels">Test Support Levels</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>None (0)</td>
<td>No tests have been written to test the specifics of the format.</td>
</tr>
<tr class="even">
<td>Basic (1)</td>
<td>Stitch Lists and/or colors have read/write tests.</td>
</tr>
<tr class="odd">
<td>Thorough (2)</td>
<td>All features of that format has at least one test.</td>
</tr>
<tr class="even">
<td>Fuzz (2)</td>
<td>Can test the format for uses of features that we haven’t thought of by feeding in nonsense that is designed to push possibly dangerous weaknesses to reveal themselves.</td>
</tr>
<tr class="odd">
<td>Complete (3)</td>
<td>Both thorough and fuzz testing is covered.</td>
</tr>
</tbody>
</table>
<p>So all formats can, in principle, have complete testing support, because it’s defined in relation to files that we have described the formats for.</p>
<h4 id="documentation-support-levels">Documentation Support Levels</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>None (0)</td>
<td>We haven’t researched this beyond finding example files.</td>
</tr>
<tr class="even">
<td>Basic (1)</td>
<td>We have a rough sketch of the size and contents of the header if there is one. We know the basic stitch encoding (if there is one), but not necessarily all stitch features.</td>
</tr>
<tr class="odd">
<td>Standard (2)</td>
<td>We know some good sources and/or have tested all the features that appear to exist. They mostly work the way we have described.</td>
</tr>
<tr class="even">
<td>Good (3)</td>
<td>All features that were described somewhere have been covered here or we have thoroughly tested our ideas against other softwares and hardwares and they work as expected.</td>
</tr>
<tr class="odd">
<td>Complete (4)</td>
<td>There is a known official description and our description covers all the same features.</td>
</tr>
</tbody>
</table>
<p>Not all formats can have complete documentation because it’s based on what information is publically available. So the total score is reported in the table below based on what level we think is available.</p>
<h4 id="table-of-format-support-levels">Table of Format Support Levels</h4>
<table>
<thead>
<tr class="header">
<th><em>Format</em></th>
<th><em>Read Support</em></th>
<th><em>Write Support</em></th>
<th><em>Specialised Tests</em></th>
<th><em>Documentation</em></th>
<th><em>Score</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#toyota-embroidery-format-100">Toyota Embroidery Format (.100)</a></td>
<td>Basic</td>
<td>Basic</td>
<td>None</td>
<td>None</td>
<td>2/11</td>
</tr>
<tr class="even">
<td><a href="#toyota-embroidery-format-10o">Toyota Embroidery Format (.10o)</a></td>
<td>Basic</td>
<td>Basic</td>
<td>None</td>
<td>None</td>
<td>2/11</td>
</tr>
<tr class="odd">
<td><a href="#bernina-embroidery-format-art">Bernina Embroidery Format (.art)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#bitmap-cache-embroidery-format-bmc">Bitmap Cache Embroidery Format (.bmc)</a></td>
<td>Basic</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1/11</td>
</tr>
<tr class="odd">
<td><a href="#bits-and-volts-embroidery-format-bro">Bits and Volts Embroidery Format (.bro)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#melco-embroidery-format-cnd">Melco Embroidery Format (.cnd)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#embroidery-thread-color-format-col">Embroidery Thread Color Format (.col)</a></td>
<td>Basic</td>
<td>Basic</td>
<td>None</td>
<td>Basic</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#singer-embroidery-format-csd">Singer Embroidery Format (.csd)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#comma-seperated-values-csv">Comma Separated Values (.csv)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#barudan-embroidery-format-dat">Barudan Embroidery Format (.dat)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#melco-embroidery-format-dem">Melco Embroidery Format (.dem)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#barudan-embroidery-format-dsb">Barudan Embroidery Format (.dsb)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#tajima-embroidery-format-dst">Tajima Embroidery Format (.dst)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#zsk-usa-embroidery-format-dsz">ZSK USA Embroidery Format (.dsz)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#drawing-exchange-format-dxf">Drawing Exchange Format (.dxf)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#embird-embroidery-format-edr">Embird Embroidery Format (.edr)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#elna-embroidery-format-emd">Elna Embroidery Format (.emd)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#melco-embroidery-format-exp">Melco Embroidery Format (.exp)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#eltac-embroidery-format-exy">Eltac Embroidery Format (.exy)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#sierra-expanded-embroidery-format-eys">Sierra Expanded Embroidery Format (.eys)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#fortran-embroidery-format-fxy">Fortron Embroidery Format (.fxy)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#smoothie-g-code-embroidery-format-gc">Smoothie G-Code Embroidery Format (.gc)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#great-notions-embroidery-format-gnc">Great Notions Embroidery Format (.gnc)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#gold-thread-embroidery-format-gt">Gold Thread Embroidery Format (.gt)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#husqvarna-viking-embroidery-format-hus">Husqvarna Viking Embroidery Format (.hus)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#inbro-embroidery-format-inb">Inbro Embroidery Format (.inb)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#embroidery-color-format-inf">Embroidery Color Format (.inf)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#janome-embroidery-format-jef">Janome Embroidery Format (.jef)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#pfaff-embroidery-format-ksm">Pfaff Embroidery Format (.ksm)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#pfaff-embroidery-format-max">Pfaff Embroidery Format (.max)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#mitsubishi-embroidery-format-mit">Mitsubishi Embroidery Format (.mit)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#ameco-embroidery-format-new">Ameco Embroidery Format (.new)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#melco-embroidery-format-ofm">Melco Embroidery Format (.ofm)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#pfaff-embroidery-format-pcd">Pfaff Embroidery Format (.pcd)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#pfaff-embroidery-format-pcm">Pfaff Embroidery Format (.pcm)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#pfaff-embroidery-format-pcq">Pfaff Embroidery Format (.pcq)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#pfaff-embroidery-format-pcs">Pfaff Embroidery Format (.pcs)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#brother-embroidery-format-pec">Brother Embroidery Format (.pec)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#brother-embroidery-format-pel">Brother Embroidery Format (.pel)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#brother-embroidery-format-pem">Brother Embroidery Format (.pem)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#brother-embroidery-format-pes">Brother Embroidery Format (.pes)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#brother-embroidery-format-phb">Brother Embroidery Format (.phb)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#brother-embroidery-format-phc">Brother Embroidery Format (.phc)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#brother-embroidery-format-plt">AutoCAD Embroidery Format (.plt)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#rgb-embroidery-format-rgb">RGB Embroidery Format (.rgb)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#janome-embroidery-format-sew">Janome Embroidery Format (.sew)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#husqvarna-viking-embroidery-format-shv">Husqvarna Viking Embroidery Format (.shv)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#sunstar-embroidery-format-sst">Sunstar Embroidery Format (.sst)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#data-stitch-embroidery-format-stx">Data Stitch Embroidery Format (.stx)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#scalable-vector-graphics-svg">Scalable Vector Graphics (.svg)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/12</td>
</tr>
<tr class="odd">
<td><a href="#pfaff-embroidery-format-t01">Pfaff Embroidery Format (.t01)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#pfaff-embroidery-format-t09">Pfaff Embroidery Format (.t09)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#happy-embroidery-format-tap">Happy Embroidery Format (.tap)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#thredworks-embroidery-format-thr">ThredWorks Embroidery Format (.thr)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#text_file_txt">Text File (.txt)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#barudan-embroidery-format-u00">Barudan Embroidery Format (.u00)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#barudan-embroidery-format-u01">Barudan Embroidery Format (.u01)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#pfaff-embroidery-format-vip">Pfaff Embroidery Format (.vip)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#pfaff-embroidery-format-vp3">Pfaff Embroidery Format (.vp3)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="even">
<td><a href="#singer-embroidery-format-xxx">Singer Embroidery Format (.xxx)</a></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>0/11</td>
</tr>
<tr class="odd">
<td><a href="#zsk_usa_embroidery_format_zsk">ZSK USA Embroidery Format (.zsk)</a></td>
<td>None</td>
<td></td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="even">
<td><em>Total</em></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0/671</td>
</tr>
</tbody>
</table>
<p>For a total of 0% coverage.</p>
<h3 id="toyota-embroidery-format-.100">Toyota Embroidery Format (.100)</h3>
<p>The Toyota 100 format is a stitch-only format that uses an external color file.</p>
<p>The stitch encoding is in 4 byte chunks.</p>
<h3 id="toyota-embroidery-format-.10o">Toyota Embroidery Format (.10o)</h3>
<p>The Toyota 10o format is a stitch-only format that uses an external color file.</p>
<p>The stitch encoding is in 3 byte chunks.</p>
<h3 id="bernina-embroidery-format-.art">Bernina Embroidery Format (.art)</h3>
<p>We don’t know much about this format. TODO: Find a source.</p>
<h3 id="bitmap-cache-embroidery-format-.bmc">Bitmap Cache Embroidery Format (.bmc)</h3>
<p>We don’t know much about this format. TODO: Find a source.</p>
<h3 id="bits-and-volts-embroidery-format-.bro">Bits and Volts Embroidery Format (.bro)</h3>
<p>The Bits and Volts bro format is a stitch-only format that uses an external color file.</p>
<p>The header is 256 bytes. There’s a series of unknown variables in the header.</p>
<p>The stitch list uses a variable length encoding which is 2 bytes for any stitch</p>
<h3 id="melco-embroidery-format-.cnd">Melco Embroidery Format (.cnd)</h3>
<p>The Melco cnd format is a stitch-only format.</p>
<p>We don’t know much about this format. TODO: Find a source.</p>
<h3 id="embroidery-thread-color-format-.col">Embroidery Thread Color Format (.col)</h3>
<p>An external color file format for formats that do not record their own colors.</p>
<p>It is a human-readable format that has a header that is a single line containing only the number of threads in decimal followed by the windows line break ‘’.</p>
<p>Then the rest of the file is a comma seperated value list of all threads with 4 values per line: the index of the thread then the red, green and blue channels of the color in that order.</p>
<h4 id="example">Example</h4>
<p>If we had a pattern called “example” with four colors: black, red, magenta and cyan in that order then the file is (with the white space written out):</p>
<p>example.col</p>
<pre><code>4\r\n
0,0,0,0\r\n
1,255,0,0\r\n
2,0,255,0\r\n
3,0,0,255\r\n</code></pre>
<h3 id="singer-embroidery-format-.csd">Singer Embroidery Format (.csd)</h3>
<p>Stitch Only Format</p>
<h3 id="comma-separated-values-.csv">Comma Separated Values (.csv)</h3>
<p>Comma Seperated Values files aren’t a universal system, here we aim to offer a broad support.</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Control Symbol</th>
<th>Type</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>#</code></td>
<td>COMMENT</td>
<td></td>
</tr>
<tr class="even">
<td><code>&gt;</code></td>
<td>VARIABLE</td>
<td>To store records of a pattern’s width, height etc. This means that data stored in the header of say a <code>.dst</code> file is preserved.</td>
</tr>
<tr class="odd">
<td><code>$</code></td>
<td>THREAD</td>
<td></td>
</tr>
<tr class="even">
<td><code>*</code></td>
<td>STITCH</td>
<td></td>
</tr>
<tr class="odd">
<td><code>*</code></td>
<td>JUMP</td>
<td></td>
</tr>
<tr class="even">
<td><code>*</code></td>
<td>COLOR</td>
<td>To change a color: used for trim as well</td>
</tr>
<tr class="odd">
<td><code>*</code></td>
<td>END</td>
<td>To end a pattern.</td>
</tr>
<tr class="even">
<td><code>*</code></td>
<td>UNKNOWN</td>
<td>For any feature that we can’t identify.</td>
</tr>
</tbody>
</table>
<h3 id="barudan-embroidery-format-.dat">Barudan Embroidery Format (.dat)</h3>
<p>Stitch Only Format</p>
<h3 id="melco-embroidery-format-.dem">Melco Embroidery Format (.dem)</h3>
<p>Stitch Only Format</p>
<h3 id="barudan-embroidery-format-.dsb">Barudan Embroidery Format (.dsb)</h3>
<ul>
<li>Stitch Only Format.</li>
<li><input type="checkbox" disabled="" checked="" />
Basic Read Support</li>
<li><input type="checkbox" disabled="" />
Basic Write Support</li>
<li><input type="checkbox" disabled="" />
Well Tested Read</li>
<li><input type="checkbox" disabled="" />
Well Tested Write</li>
</ul>
<h3 id="tajima-embroidery-format-.dst">Tajima Embroidery Format (.dst)</h3>
<ul>
<li>Stitch Only Format.</li>
<li><input type="checkbox" disabled="" checked="" />
Basic Read Support</li>
<li><input type="checkbox" disabled="" checked="" />
Basic Write Support</li>
<li><input type="checkbox" disabled="" />
Well Tested Read</li>
<li><input type="checkbox" disabled="" />
Well Tested Write</li>
</ul>
<p>.DST (Tajima) embroidery file read/write routines Format comments are thanks to tspilman@dalcoathletic.com who’s notes appeared at  under Tajima Format.</p>
<h4 id="header">Header</h4>
<p>The header seems to contain information about the design. Seems to be ASCII text delimited by 0x0D (carriage returns). This must be in the file for most new software or hardware to consider it a good file! This is much more important than I originally believed. The header is 125 bytes in length and padded out by 0x20 to 512 bytes total. All entries in the header seem to be 2 ASCII characters followed by a colon, then it’s value trailed by a carriage return.</p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="header">
<th><em>C memory</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>char LA[16+1];</code></td>
<td>First is the ‘LA’ entry, which is the design name with no path or extension information. The blank is 16 characters in total, but the name must not be longer that 8 characters and padded out with spaces (0x20).</td>
</tr>
<tr class="even">
<td><code>char ST[7+1];</code></td>
<td>Next is the stitch count ST, this is a 7 digit number padded by leading zeros. This is the total stitch count including color changes, jumps, nups, and special records.</td>
</tr>
<tr class="odd">
<td><code>char CO[3+1];</code></td>
<td>Next, is CO or colors, a 3 digit number padded by leading zeros. This is the number of color change records in the file.</td>
</tr>
<tr class="even">
<td><code>char POSX[5+1];</code></td>
<td>Next is +X or the positive X extent in centimeters, a 5 digit non-decimal number padded by leading zeros.</td>
</tr>
<tr class="odd">
<td><code>char NEGX[5+1];</code></td>
<td>Following is the -X or the negative X extent in millimeters, a 5 digit non-decimal number padded by leading zeros.</td>
</tr>
<tr class="even">
<td><code>char POSY[5+1];</code></td>
<td>Again, the +Y extents.</td>
</tr>
<tr class="odd">
<td><code>char NEGY[5+1];</code></td>
<td>Again, the -Y extents.</td>
</tr>
<tr class="even">
<td><code>char AX[6+1]; char AY[6+1];</code></td>
<td>AX and AY should express the relative coordinates of the last point from the start point in 0.1 mm. If the start and last points are the same, the coordinates are (0,0).</td>
</tr>
<tr class="odd">
<td><code>char MX[6+1];</code> <code>char MY[6+1];</code></td>
<td>MX and MY should express coordinates of the last point of the previous file for a multi-volume design. A multi-volume design means a design consisted of two or more files. This was used for huge designs that can not be stored in a single paper tape roll. It is not used so much (almost never) nowadays.</td>
</tr>
<tr class="even">
<td><code>char PD[9+1];</code></td>
<td>PD is also storing some information for multi-volume design.</td>
</tr>
</tbody>
</table>
<p>Uses 3 byte per stitch encoding with the format as follows:</p>
<p>The 3 byte encoding for the dxf format.</p>
<table>
<thead>
<tr class="header">
<th><em>Bit</em></th>
<th><em>7</em></th>
<th><em>6</em></th>
<th><em>5</em></th>
<th><em>4</em></th>
<th><em>3</em></th>
<th><em>2</em></th>
<th><em>1</em></th>
<th><em>0</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Byte 0</td>
<td>y+1</td>
<td>y-1</td>
<td>y+9</td>
<td>y-9</td>
<td>x-9</td>
<td>x+9</td>
<td>x-1</td>
<td>x+1</td>
</tr>
<tr class="even">
<td>Byte 1</td>
<td>y+3</td>
<td>y-3</td>
<td>y+27</td>
<td>y-27</td>
<td>x-27</td>
<td>x+27</td>
<td>x-3</td>
<td>x+3</td>
</tr>
<tr class="odd">
<td>Byte 2</td>
<td>jump</td>
<td>color change</td>
<td>y+81</td>
<td>y-81</td>
<td>x-81</td>
<td>x+81</td>
<td>set</td>
<td>set</td>
</tr>
</tbody>
</table>
<p>T01 and Tap appear to use Tajima Ternary.</p>
<p>Where the stitch type is determined as:</p>
<ul>
<li>Normal Stitch <code>00000011 0x03</code></li>
<li>Jump Stitch <code>10000011 0x83</code></li>
<li>Stop/Change Color <code>11000011 0xC3</code></li>
<li>End Design <code>11110011 0xF3</code></li>
</ul>
<p>Inclusive or’ed with the last byte.</p>
<p>Note that:</p>
<ol type="1">
<li>The max stitch length is the largest sum of <code>1+3+9+27+81=121</code> where the unit length is 0.1mm so 12.1mm.</li>
<li>The coordinate system is right handed.</li>
</ol>
<h3 id="zsk-usa-embroidery-format-.dsz">ZSK USA Embroidery Format (.dsz)</h3>
<p>The ZSK USA dsz format is stitch-only.</p>
<h3 id="drawing-exchange-format-.dxf">Drawing Exchange Format (.dxf)</h3>
<p>Graphics format.</p>
<h3 id="embird-embroidery-format-.edr">Embird Embroidery Format (.edr)</h3>
<p>Stitch Only Format</p>
<h3 id="elna-embroidery-format-.emd">Elna Embroidery Format (.emd)</h3>
<p>Stitch Only Format.</p>
<h3 id="melco-embroidery-format-.exp">Melco Embroidery Format (.exp)</h3>
<p>Stitch Only Format.</p>
<h3 id="eltac-embroidery-format-.exy">Eltac Embroidery Format (.exy)</h3>
<p>Stitch Only Format.</p>
<h3 id="sierra-expanded-embroidery-format-.eys">Sierra Expanded Embroidery Format (.eys)</h3>
<p>Stitch Only Format.</p>
<p>Smoothie G-Code Embroidery Format (.fxy)?</p>
<h3 id="fortron-embroidery-format-.fxy">Fortron Embroidery Format (.fxy)</h3>
<p>Stitch Only Format.</p>
<h3 id="great-notions-embroidery-format-.gnc">Great Notions Embroidery Format (.gnc)</h3>
<p>Stitch Only Format.</p>
<h2 id="gold-thread-embroidery-format-.gt">Gold Thread Embroidery Format (.gt)</h2>
<p>Stitch Only Format.</p>
<h3 id="husqvarna-viking-embroidery-format-.hus">Husqvarna Viking Embroidery Format (.hus)</h3>
<p>Stitch Only Format.</p>
<h3 id="inbro-embroidery-format-.inb">Inbro Embroidery Format (.inb)</h3>
<p>Stitch Only Format.</p>
<h3 id="embroidery-color-format-.inf">Embroidery Color Format (.inf)</h3>
<p>Stitch Only Format.</p>
<h3 id="janome-embroidery-format-.jef">Janome Embroidery Format (.jef)</h3>
<p>Stitch Only Format.</p>
<h3 id="pfaff-professional-design-format-.ksm">Pfaff professional Design format (.ksm)</h3>
<p>Stitch Only Format.</p>
<h3 id="pfaff-embroidery-format-.max">Pfaff Embroidery Format (.max)</h3>
<p>Stitch Only Format.</p>
<h3 id="mitsubishi-embroidery-format-.mit">Mitsubishi Embroidery Format (.mit)</h3>
<p>Stitch Only Format.</p>
<h3 id="ameco-embroidery-format-.new">Ameco Embroidery Format (.new)</h3>
<p>Stitch Only Format.</p>
<h3 id="melco-embroidery-format-.ofm">Melco Embroidery Format (.ofm)</h3>
<p>Stitch Only Format.</p>
<h3 id="pfaff-pcd-file-format">Pfaff PCD File Format</h3>
<p>Stitch Only Format.</p>
<p>The format uses a signed 3 byte-length number type.</p>
<p>See the description here (<a href="#5">5</a>) for the overview of the format.</p>
<p>For an example of the format see (<a href="#11">11</a>).</p>
<h3 id="pfaff-embroidery-format-.pcm">Pfaff Embroidery Format (.pcm)</h3>
<p>The Pfaff pcm format is stitch-only.</p>
<h3 id="pfaff-embroidery-format-.pcq">Pfaff Embroidery Format (.pcq)</h3>
<p>The Pfaff pcq format is stitch-only.</p>
<h3 id="pfaff-embroidery-format-.pcs">Pfaff Embroidery Format (.pcs)</h3>
<p>The Pfaff pcs format is stitch-only.</p>
<h3 id="brother-embroidery-format-.pec">Brother Embroidery Format (.pec)</h3>
<p>The Brother pec format is stitch-only.</p>
<h3 id="brother-embroidery-format-.pel">Brother Embroidery Format (.pel)</h3>
<p>The Brother pel format is stitch-only.</p>
<h3 id="brother-embroidery-format-.pem">Brother Embroidery Format (.pem)</h3>
<p>The Brother pem format is stitch-only.</p>
<h3 id="brother-embroidery-format-.pes">Brother Embroidery Format (.pes)</h3>
<p>The Brother pes format is stitch-only.</p>
<pre><code>struct PEShdr
{
char PESId[8];
DWORD PECOffset;
};</code></pre>
<h3 id="brother-embroidery-format-.phb">Brother Embroidery Format (.phb)</h3>
<p>The Brother phb format is stitch-only.</p>
<h3 id="brother-embroidery-format-.phc">Brother Embroidery Format (.phc)</h3>
<p>The Brother phc format is stitch-only.</p>
<h3 id="autocad-embroidery-format-.plt">AutoCAD Embroidery Format (.plt)</h3>
<p>The AutoCAD plt format is stitch-only.</p>
<h3 id="rgb-embroidery-format-.rgb">RGB Embroidery Format (.rgb)</h3>
<p>The RGB format is a color-only format to act as an external color file for other formats.</p>
<h3 id="janome-embroidery-format-.sew">Janome Embroidery Format (.sew)</h3>
<p>The Janome sew format is stitch-only.</p>
<h3 id="husqvarna-viking-embroidery-format-.shv">Husqvarna Viking Embroidery Format (.shv)</h3>
<p>The Husqvarna Viking shv format is stitch-only.</p>
<h3 id="sunstar-embroidery-format-.sst">Sunstar Embroidery Format (.sst)</h3>
<p>The Sunstar sst format is stitch-only.</p>
<h3 id="data-stitch-embroidery-format-.stx">Data Stitch Embroidery Format (.stx)</h3>
<p>The Data Stitch stx format is stitch-only.</p>
<h3 id="scalable-vector-graphics-.svg">Scalable Vector Graphics (.svg)</h3>
<p>The scalable vector graphics (SVG) format is a graphics format maintained by …</p>
<h3 id="pfaff-embroidery-format-.t01">Pfaff Embroidery Format (.t01)</h3>
<p>The Pfaff t01 format is stitch-only.</p>
<h3 id="pfaff-embroidery-format-.t09">Pfaff Embroidery Format (.t09)</h3>
<p>The Pfaff t09 format is stitch-only.</p>
<h3 id="happy-embroidery-format-.tap">Happy Embroidery Format (.tap)</h3>
<p>The Happy tap format is stitch-only.</p>
<h3 id="thredworks-embroidery-format-.thr">ThredWorks Embroidery Format (.thr)</h3>
<p>The ThreadWorks thr format is stitch-only.</p>
<h3 id="text-file-.txt">Text File (.txt)</h3>
<p>The txt format is stitch-only and isn’t associated with a specific company.</p>
<h3 id="barudan-embroidery-format-.u00">Barudan Embroidery Format (.u00)</h3>
<p>The Barudan u00 format is stitch-only.</p>
<h3 id="barudan-embroidery-format-.u01">Barudan Embroidery Format (.u01)</h3>
<p>The Barudan u01 format is stitch-only.</p>
<h3 id="pfaff-embroidery-format-.vip">Pfaff Embroidery Format (.vip)</h3>
<p>The Pfaff vip format is stitch-only.</p>
<h3 id="pfaff-embroidery-format-.vp3">Pfaff Embroidery Format (.vp3)</h3>
<p>The Pfaff vp3 format is stitch-only.</p>
<h3 id="singer-embroidery-format-.xxx">Singer Embroidery Format (.xxx)</h3>
<p>The Singer xxx format is stitch-only.</p>
<h3 id="zsk-usa-embroidery-format-.zsk">ZSK USA Embroidery Format (.zsk)</h3>
<p>The ZSK USA zsk format is stitch-only.</p>
<h2 id="on-embedded-systems">On Embedded Systems</h2>
<p>The library is designed to support embedded environments, so it can be used in CNC applications.</p>
<h3 id="compatible-boards">Compatible Boards</h3>
<p>We recommend using an Arduino Mega 2560 or another board with equal or greater specs. That being said, we have had success using an Arduino Uno R3 but this will likely require further optimization and other improvements to ensure continued compatibility with the Uno. See below for more information.</p>
<h3 id="arduino-considerations">Arduino Considerations</h3>
<p>There are two main concerns here: Flash Storage &amp; SRAM.</p>
<p>libembroidery continually outgrows the 32KB of Flash storage on the Arduino Uno and every time this occurs, a decision has to be made as to what capabilities should be included or omitted. While reading files is the main focus on arduino, writing files may also play a bigger role in the future. Long term, it would be most practical to handle the inclusion or omission of any feature via a single configuration header file that the user can modify to suit their needs.</p>
<p>SRAM is in extremely limited supply and it will deplete quickly so any dynamic allocation should occur early during the setup phase of the sketch and sparingly or not at all later in the sketch. To help minimize SRAM consumption on Arduino and ensure libembroidery can be used in any way the sketch creator desires, it is required that any sketch using libembroidery must implement event handlers. See the ino-event source and header files for more information.</p>
<p>There is also an excellent article by Bill Earl on the Adafruit Learning System which covers these topics in more depth: .</p>
<h3 id="space">Space</h3>
<p>Since a stitch takes 3 bytes of storage and many patterns use more than 10k stitches, we can’t assume that the pattern will fit in memory. Therefore we will need to buffer the current pattern on and off storage in small chunks. By the same reasoning, we can’t load all of one struct beore looping so we will need functions similar to binaryReadInt16 for each struct.</p>
<p>This means the EmbArray approach won’t work since we need to load each element and dynamic memory management is unnecessary because the arrays lie in storage.</p>
<p>TODO: Replace EmbArray functions with embPattern load functions.</p>
<h3 id="tables">Tables</h3>
<p>All thread tables and large text blocks are too big to compile directly into the source code. Instead we can package the library with a data packet that is compiled from an assembly program in raw format so the specific padding can be controlled.</p>
<p>In the user section above we will make it clear that this file needs to be loaded on the pattern USB/SD card or the program won’t function.</p>
<p>TODO: Start file with a list of offsets to data with a corresponding table to load into with macro constants for each label needed.</p>
<h3 id="current-pattern-memory-management">Current Pattern Memory Management</h3>
<p>It will be simpler to make one file per EmbArray so we keep an EmbFile* and a length, so no malloc call is necessary. So there needs to be a consistent tmpfile naming scheme.</p>
<p>TODO: For each pattern generate a random string of hexadecimal and append it to the filenames like . Need to check for a file which indicates that this string has been used already.</p>
<h3 id="special-notes">Special Notes</h3>
<p>Due to historical reasons and to remain compatible with the Arduino 1.0 IDE, this folder must be called ``utility’’. Refer to the arduino build process for more info: https://arduino.github.io/arduino-cli/0.19/sketch-build-process/</p>
<p>libembroidery relies on the Arduino SD library for reading files. See the ino-file source and header files for more information.</p>
<h2 id="the-assembly-split">The Assembly Split</h2>
<p>One problem to the problem of supporting both systems with abundant memory (such as a 2010s or later desktop) and with scarce memory (such as embedded systems) is that they don’t share the same assembly language. To deal with this: there will be two equivalent software which are hand engineered to be similar but one will be in C and the other in the assembly dialects we support.</p>
<p>All assembly will be intended for embedded systems only, since a slightly smaller set of features will be supported. However, we will write a <code>x86</code> version since that can be tested.</p>
<p>That way the work that has been done to simplify the C code can be applied to the assembly versions.</p>
<h2 id="build-1">Build</h2>
<p>To build the documentation run <code>make</code>. This should run no problem on a normal Unix-like environment assuming pandoc is available.</p>
<ul>
<li>Pandoc creates the content of the page by converting the markdown to html.</li>
<li>Pandoc also creates the printer-friendly documentation from the same markdown.</li>
<li>Markdown acts as a go-between because it is easy to alter directly in the GH editor.</li>
</ul>
<p>This way: 1. We write one set of documents for all projects. 2. The website can be simple and static, supporting machines that don’t run javascript. 3. We control the styling of each version independently of our editing (Markdown) version 4. The printer-friendly documentation can have nicely rendered fonts and well placed figures.</p>
<h2 id="features">Features</h2>
<h3 id="bindings">Bindings</h3>
<p>Bindings for libembroidery are maintained for the languages we use internally in the project, for other languages we consider that the responsibility of other teams using the library.</p>
<p>So libembroidery is going to be supported on:</p>
<pre><code>* C (by default)
* C++ (also by default)
* Java (for the Android application MobileViewer)
* Swift (for the iOS application iMobileViewer)</code></pre>
<p>For C# we recommend directly calling the function directly using the DllImport feature:</p>
<pre><code>    [DllImport(&quot;libembroidery.so&quot;, EntryPoint=&quot;readCsv&quot;)]</code></pre>
<p>see this StackOverflow discussion <a href="https://stackoverflow.com/questions/11425202/is-it-possible-to-call-a-c-function-from-c-net">for help</a>.</p>
<p>For Python you can do the same using <a href="https://www.geeksforgeeks.org/how-to-call-a-c-function-in-python/">ctypes</a>.</p>
<h2 id="threads">Threads</h2>
<ul>
<li><a href="#dxf_color_table">DXF Color Table</a></li>
<li><a href="#hus_color_table">HUS Color Table</a></li>
<li><a href="#jef_color_table">JEF Color Table</a></li>
<li><a href="#pcm_color_table">PCM Color Table</a></li>
<li><a href="#pec_color_table">PEC Color Table</a></li>
</ul>
<h3 id="dxf-color-table">DXF color table</h3>
<h3 id="hus-color-table">HUS color table</h3>
<h3 id="jef-color-table">JEF color table</h3>
<h3 id="pcm-color-table">PCM color table</h3>
<h3 id="pec-color-table">PEC color table</h3>
<h2 id="other-supported-thread-brands">Other Supported Thread Brands</h2>
<p>The thread lists that aren’t preprogrammed into formats but are indexed in the data file for the purpose of conversion or fitting to images/graphics.</p>
<ul>
<li>Arc Polyester</li>
<li>Arc Rayon</li>
<li>Coats and Clark Rayon</li>
<li>Exquisite Polyester</li>
<li>Fufu Polyester</li>
<li>Fufu Rayon</li>
<li>Hemingworth Polyester</li>
<li>Isacord Polyester</li>
<li>Isafil Rayon</li>
<li>Marathon Polyester</li>
<li>Marathon Rayon</li>
<li>Madeira Polyester</li>
<li>Madeira Rayon</li>
<li>Metro Polyester</li>
<li>Pantone</li>
<li>Robison Anton Polyester</li>
<li>Robison Anton Rayon</li>
<li>Sigma Polyester</li>
<li>Sulky Rayon</li>
<li>ThreadArt Rayon</li>
<li>ThreadArt Polyester</li>
<li>ThreaDelight Polyester</li>
<li>Z102 Isacord Polyester</li>
</ul>
<h1 id="development">Development</h1>
<p>A <em>right-handed coordinate system</em> is one where up is positive and right is positive. Left-handed is up is positive, left is positive. Screens often use down is positive, right is positive, including the OpenGL standard so when switching between graphics formats and stitch formats we need to use a vertical flip (<code>embPattern_flip</code>).</p>
<p><code>0x20</code> is the space symbol, so when padding either 0 or space is preferred and in the case of space use the literal ’ ’.</p>
<h3 id="design-philosophy-and-coding-standards">Design Philosophy and Coding Standards</h3>
<ol type="1">
<li>No GUI code will be present in <code>libembroidery</code>.</li>
<li>The library will be written in pedantic ANSI C/C90, aiming for no compiler warnings under GCC for compatibility with the most possible platforms.</li>
<li>The command line program <code>embroider</code> targets 32-bit and 64 bit systems that comply to POSIX or current Windows/MacOS standards. Practically, this means we only call C99 standard library functions.</li>
<li>Don’t use any of the C Standard Library. All interfacing should be done by linux system calls or their equivalents.</li>
<li>Never use dynamic memory allocation (malloc/free) all memory that would need those functions uses temporary files instead.</li>
<li>Share heavy memory usage between functions, for example use embBuffer for buffering headers rather than having a separate <code>char header[]</code> variables.</li>
</ol>
<h3 id="image-fitting">Image Fitting</h3>
<p>A currently unsolved problem in development that warrants further research is the scenario where a user wants to feed embroider an image that can then be .</p>
<h2 id="to-do">To Do</h2>
<p>We currently need help with:</p>
<ol type="1">
<li>Thorough descriptions of each embroidery format.</li>
<li>Finding resources for each of the branded thread libraries (along with a full citation for documentation).</li>
<li>Finding resources for each geometric algorithm used (along with a full citation for documentation).</li>
<li>Completing the full <code>--full-test-suite</code> with no segfaults and at least a clear error message (for example “not implemented yet”).</li>
<li>Identifying “best guesses” for filling in missing information when going from, say <code>.csv</code> to a late <code>.pes</code> version. What should the default be when the data doesn’t clarify?</li>
<li>Improving the written documentation.</li>
<li>Funding, see the Sponsor button above. We can treat this as “work” and put far more hours in with broad support in small donations from people who want specific features.</li>
</ol>
<p>Beyond this the development targets are categories sorted into:</p>
<ol type="1">
<li><a href="#basic-features">Basic Features</a></li>
<li><a href="#code-quality-and-user-friendliness">Code quality and user friendliness</a></li>
<li><a href="#embroider-cli">embroider CLI</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#gui">GUI</a></li>
<li><a href="#electronics-development">electronics development</a></li>
</ol>
<h4 id="basic-features.">Basic features.</h4>
<ol type="1">
<li>Incorporate ed parts of .</li>
<li>Interpret how to write formats that have a read mode from the source code and vice versa.</li>
<li>Document the specifics of the file formats here for embroidery machine specific formats. Find websites and other sources that break down the binary formats we currently don’t understand.</li>
<li>Find more and better documentation of the structure of the headers for the formats we do understand.</li>
</ol>
<h4 id="code-quality-and-user-friendliness">Code quality and user friendliness</h4>
<ol type="1">
<li>Document all structs, macros and functions (will contribute directly on the web version).</li>
<li>Incorporate experimental code, improve support for language bindings.</li>
<li>Make stitch x, y into an EmbVector.</li>
</ol>
<h4 id="embroider-cli">embroider CLI</h4>
<ol type="1">
<li>Make -circle flag to add a circle to the current pattern.</li>
<li>Make -rect flag to add a rectangle to the current pattern.</li>
<li>Make -fill flag to set the current satin fill algorithm for the current geometry. (for example ``-fill crosses -circle 11,13,10’’ fills a circle with center 11mm, 13mm with radius 10mm with crosses).</li>
<li>Make -ellipse flag to add to ellipse to the current pattern.</li>
<li>Make -bezier flag to add a bezier curve to the current pattern.</li>
</ol>
<h5 id="embroider-pipeline">Embroider pipeline</h5>
<p>Adjectives apply to every following noun so</p>
<pre><code>embroider --satin 0.3,0.6 --thickness 2 --circle 10,20,5 \
    --border 3 --disc 30,40,10 --arc 30,50,10,60 output.pes</code></pre>
<p>Creates:</p>
<ol type="1">
<li>a circle with properties: thickness 2, satin 0.3,0.6</li>
<li>a disc with properties:</li>
<li>an arc with properties:</li>
</ol>
<p>in that order then writes them to the output file <code>output.pes</code>.</p>
<h4 id="documentation">Documentation</h4>
<ol type="1">
<li>Create csv data files for thread tables.</li>
<li>Convert tex to markdown, make tex an output of <code>build.bash</code>.</li>
<li>Run <code>sloccount</code> on <code>extern/</code> and <code>.</code> (and ) so we know the current scale of the project, aim to get this number low. Report the total as part of the documentation.</li>
<li>Try to get as much of the source code that we maintain into C as possible so new developers don’t need to learn multiple languages to have an effect. This bars the embedded parts of the code.</li>
</ol>
<h4 id="gui">GUI</h4>
<ol type="1">
<li>Make MobileViewer also backend to <code>libembroidery</code> with a Java wrapper.</li>
<li>Make iMobileViewer also backend to <code>libembroidery</code> with a Swift wrapper.</li>
<li>Share some of the MobileViewer and iMobileViewer layout with the main EM2. Perhaps combine those 3 into the Embroidermodder repository so there are 4 repositories total.</li>
<li>Convert layout data to JSON format and use cJSON for parsing.</li>
</ol>
<h4 id="electronics-development">Electronics development</h4>
<ol type="1">
<li>Currently experimenting with Fritzing^(<em>8</em>), upload netlists to embroiderbot when they can run simulations using the asm in <code>libembroidery</code>.</li>
<li>Create a common assembly for data that is the same across chipsets <code>libembrodiery_data_internal.s</code>.</li>
<li>Make the defines part of <code>embroidery.h</code> all systems and the function list “c code only”. That way we can share some development between assembly and C versions.</li>
</ol>
<h2 id="bibliography">Bibliography</h2>
<ol type="1">
<li><a name="1"></a> Rudolf <em>Technical Info</em> <a href="http://www.achatina.de/sewing/main/TECHNICL.HTM">http://www.achatina.de/sewing/main/TECHNICL.HTM</a> (Accessed 25 November 2021)</li>
<li><a name="2"></a> fineEmbStudio2021</li>
<li><a name="3"></a> Edutech format description (eduTechWikiDST)</li>
<li><a name="4"></a> KDE Liberty Description (libertyTajima)</li>
<li><a name="5"></a> The Sewing Witch <em>PCD2FMT</em> <a href="http://www.sewingwitch.com/sewing/bin/pcd2fmt.html">http://www.sewingwitch.com/sewing/bin/pcd2fmt.html</a> (Accessed November 2021)</li>
<li><a name="6"></a> <a href="http://steve-jansen.github.io/guides/windows-batch-scripting/part-7-functions.html">http://steve-jansen.github.io/guides/windows-batch-scripting/part-7-functions.html</a></li>
<li><a name="7"></a> <a href="https://stackoverflow.com/questions/16286134/imagemagick-how-can-i-work-with-histogram-result">https://stackoverflow.com/questions/16286134/imagemagick-how-can-i-work-with-histogram-result</a></li>
<li><a name="8"></a> Fritzing <a href="https://github.com/fritzing/fritzing-app">https://github.com/fritzing/fritzing-app</a></li>
<li><a name="9"></a> Sahoo, P., Wilkins, C., and Yeager, J., “Threshold selection using Renyi’s entropy”, <em>Pattern Recognition</em>, vol. 30, no. 1, pp. 71–84, 1997. doi:10.1016/S0031-3203(96)00065-9.</li>
<li><a name="10"></a> <a href="http://www.fmwconcepts.com/imagemagick/sahoothresh/index.php">http://www.fmwconcepts.com/imagemagick/sahoothresh/index.php</a> (Accessed 12 Dec 2021)</li>
<li><a name="11"></a> FINDME</li>
</ol>
</br>
<i>Copyright 2013-2021 The Embroidermodder Team</i>
</br>
        </div>
    </div>
</div>
</body>
</html>
